# Starter workflow. See docs/CI_CD_GUIDE.md for how to add real CI (tests, lint, build).
# Copy or rename to e.g. tests.yml and add triggers (on: push, pull_request) and jobs.
name: Placeholder
permissions: 
  contents: read
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
jobs:
  placeholder:
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:16-alpine
        env:
          POSTGRES_USER: app
          POSTGRES_PASSWORD: app
          POSTGRES_DB: app
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432
      mongo:
        image: mongo:7
        ports:
          - 27017:27017
    env:
      APP_POSTGRES_URL: postgresql+asyncpg://app:app@localhost:5432/app
      APP_MONGO_URL: mongodb://localhost:27017
      APP_MONGO_DB: app
    steps:
      - name: Checkout
        uses: actions/checkout@v6.0.2

      - name: Setup Python
        uses: actions/setup-python@v6
        with:
          python-version: "3.12"

      - name: Install dependencies
        run: pip install -r requirements.txt
        working-directory: backend

      - name: Run pytest
        run: pytest
        working-directory: backend
      
